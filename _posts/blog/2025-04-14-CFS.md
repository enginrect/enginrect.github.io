---
title: CFS & Kubernetes CPU ì œì–´
description: CPU ì œì–´ë¥¼ ìœ„í•œ CFS ìŠ¤ì¼€ì¤„ëŸ¬
author: jay
date: 2025-04-14 12:00:00 +0800
categories: [Blogging]
tags: [blog, devops, kubernetes]
pin: false
math: true
mermaid: true
---

## CFSë€? (Completely Fair Scheduler)

> ğŸ“˜ ê³µì‹ ë¬¸ì„œ: [Linux CFS Scheduler](https://www.kernel.org/doc/Documentation/scheduler/sched-design-CFS.txt)

- CFSëŠ” ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì˜ ê¸°ë³¸ CPU ìŠ¤ì¼€ì¤„ëŸ¬ë¡œ, ëª¨ë“  íƒœìŠ¤í¬ê°€ **ê³µì •í•˜ê²Œ CPU ì‹œê°„ì„ í• ë‹¹**ë°›ë„ë¡ ì„¤ê³„ë¨.
- ê° í”„ë¡œì„¸ìŠ¤ëŠ” **virtual runtime**ì´ë¼ëŠ” ê°œë…ì„ ê°€ì§€ë©°, ëœ ì‹¤í–‰ëœ í”„ë¡œì„¸ìŠ¤ê°€ ë” ìš°ì„ ê¶Œì„ ê°€ì§.
- ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ íƒœìŠ¤í¬ì— ìœ ë¦¬í•˜ì§€ë§Œ, ì „ì²´ì ìœ¼ë¡œëŠ” "ê³µì •í•œ ì‹œê°„ ë¶„ë°°"ë¥¼ ë³´ì¥í•¨.

## ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ CPU ì œí•œì€ ì–´ë–»ê²Œ ì´ë¤„ì§ˆê¹Œ?

> ğŸ“˜ ê³µì‹ ë¬¸ì„œ: [Kubernetes - Managing Resources for Containers](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/)

- ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” ì»¨í…Œì´ë„ˆì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ì œí•œí•˜ê¸° ìœ„í•´ **cgroupì„ ì‚¬ìš©**í•¨.
- `resources.limits.cpu`ë¥¼ ì„¤ì •í•˜ë©´, ë¦¬ëˆ…ìŠ¤ëŠ” í•´ë‹¹ ì œí•œì„ **CFS quotaì™€ period**ë¡œ ë³€í™˜í•¨.

ì˜ˆì‹œ:
```yaml
resources:
limits:
cpu: "1"  # CPU 1ê°œê¹Œì§€ ì œí•œ
requests:
cpu: "0.5"  # ìŠ¤ì¼€ì¤„ë§ ê¸°ì¤€ì€ 0.5ê°œ
```

- ìœ„ ì„¤ì •ì€ CFSë¥¼ í†µí•´ 100ms ì¤‘ 100msê¹Œì§€ë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ê²Œ ì„¤ì •í•¨. (default period: 100ms)
- ì¸í•´ CPUê°€ ê³¼í•˜ê²Œ ì‚¬ìš©ë˜ì§€ ì•Šë„ë¡ ë³´ì¥í•¨.

## Kubernetes QoS Classì™€ CPU ì œì–´ ë°©ì‹

| QoS Class    | cgroup ì„¤ì • ë°©ì‹       | CFS ì œì–´ ë°©ì‹          | ìš°ì„ ìˆœìœ„ | Throttling ê°€ëŠ¥ì„± |
|--------------|------------------------|------------------------|----------|-------------------|
| Guaranteed   | Quota + Period (Full)  | ëª…í™•í•˜ê²Œ ì œí•œ          | ë†’ìŒ     | ì˜ˆì¸¡ ê°€ëŠ¥í•˜ê²Œ ì œí•œ |
| Burstable    | Partial                | ê°€ë³€ì  ì œí•œ            | ì¤‘ê°„     | ìƒí™©ì— ë”°ë¼ ë°œìƒ  |
| BestEffort   | ì—†ìŒ                   | ë¦¬ì†ŒìŠ¤ ê²½í•© ì‹œ ë¶ˆë¦¬í•¨  | ë‚®ìŒ     | ë¦¬ì†ŒìŠ¤ ë¶€ì¡± ì‹œ ì‹¬í•¨ |

- `Guaranteed`: `requests`ì™€ `limits`ê°€ ë™ì¼í•˜ê²Œ ì„¤ì •ëœ ê²½ìš°
- `Burstable`: ì¼ë¶€ë§Œ ì„¤ì •ëœ ê²½ìš°
- `BestEffort`: `requests`ì™€ `limits` ëª¨ë‘ ë¯¸ì„¤ì •ëœ ê²½ìš°

---

## ì •ë¦¬

- KubernetesëŠ” CFS ìŠ¤ì¼€ì¤„ëŸ¬ì™€ cgroup ì„¤ì •ì„ í†µí•´ **ì»¨í…Œì´ë„ˆì˜ CPU ìì›ì„ ì •êµí•˜ê²Œ ì œì–´**í•¨.
- `cpu.cfs_quota_us`ì™€ `cpu.cfs_period_us` ì„¤ì •ì€ ì»¨í…Œì´ë„ˆë§ˆë‹¤ ì–¼ë§ˆë‚˜ CPUë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì„ì§€ë¥¼ ê²°ì •í•¨.
- ì´ëŠ” ë©€í‹°í…Œë„Œì‹œ í™˜ê²½ì—ì„œ íŠ¹ì • ì›Œí¬ë¡œë“œê°€ ê³¼ë„í•˜ê²Œ ìì›ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ë°©ì§€í•¨.